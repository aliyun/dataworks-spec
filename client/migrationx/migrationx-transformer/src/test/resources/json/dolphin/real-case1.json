[
  {
    "processDefinition": {
      "id": 20,
      "code": 13544367880867,
      "name": "市场星空roi计算",
      "version": 3,
      "releaseState": "ONLINE",
      "projectCode": 7461621920032,
      "description": "",
      "globalParams": "[]",
      "globalParamList": [],
      "globalParamMap": {},
      "createTime": "2024-05-09 09:16:26",
      "updateTime": "2024-05-09 09:19:54",
      "flag": "YES",
      "userId": 1,
      "userName": null,
      "projectName": null,
      "locations": "[{\"taskCode\":13544367880864,\"x\":193,\"y\":220},{\"taskCode\":13544367880865,\"x\":193,\"y\":375},{\"taskCode\":13544367880866,\"x\":193,\"y\":526}]",
      "scheduleReleaseState": null,
      "timeout": 0,
      "tenantId": -1,
      "tenantCode": null,
      "modifyBy": null,
      "warningGroupId": 0,
      "executionType": "PARALLEL"
    },
    "processTaskRelationList": [
      {
        "id": 174,
        "name": "",
        "processDefinitionVersion": 3,
        "projectCode": 7461621920032,
        "processDefinitionCode": 13544367880867,
        "preTaskCode": 0,
        "preTaskVersion": 0,
        "postTaskCode": 13544367880864,
        "postTaskVersion": 3,
        "conditionType": "NONE",
        "conditionParams": {},
        "createTime": "2024-05-09 09:19:54",
        "updateTime": "2024-05-09 09:19:54",
        "operator": 1,
        "operateTime": "2024-05-09 09:19:54"
      },
      {
        "id": 175,
        "name": "",
        "processDefinitionVersion": 3,
        "projectCode": 7461621920032,
        "processDefinitionCode": 13544367880867,
        "preTaskCode": 13544367880864,
        "preTaskVersion": 3,
        "postTaskCode": 13544367880865,
        "postTaskVersion": 3,
        "conditionType": "NONE",
        "conditionParams": {},
        "createTime": "2024-05-09 09:19:54",
        "updateTime": "2024-05-09 09:19:54",
        "operator": 1,
        "operateTime": "2024-05-09 09:19:54"
      },
      {
        "id": 176,
        "name": "",
        "processDefinitionVersion": 3,
        "projectCode": 7461621920032,
        "processDefinitionCode": 13544367880867,
        "preTaskCode": 13544367880865,
        "preTaskVersion": 3,
        "postTaskCode": 13544367880866,
        "postTaskVersion": 3,
        "conditionType": "NONE",
        "conditionParams": {},
        "createTime": "2024-05-09 09:19:54",
        "updateTime": "2024-05-09 09:19:54",
        "operator": 1,
        "operateTime": "2024-05-09 09:19:54"
      }
    ],
    "taskDefinitionList": [
      {
        "id": 127,
        "code": 13544367880864,
        "name": "arpu系数计算",
        "version": 3,
        "description": "",
        "projectCode": 7461621920032,
        "userId": 1,
        "taskType": "PYTHON",
        "taskParams": {
          "localParams": [],
          "rawScript": "import math\nfrom pyhive import hive\nimport numpy\nimport pandas as pd\nimport datetime\n\ncnn = hive.Connection(host='127.0.0.1', port=10000)\ncursor = cnn.cursor()\n\n\nsql_move = '''\nCREATE TABLE IF NOT EXISTS `buzi_mkt`.`mkt_sky_arpu_media_inc_d`(\n    `media_name` STRING,\n    `arpu_rate` DOUBLE,\n    `ad_placement_type` INT\n) COMMENT '媒体arpu' PARTITIONED BY (`dt` STRING COMMENT '日期')\n'''\ncursor.execute(sql_move)\ncnn.commit()\ncursor.close()\ncnn.close()",
          "resourceList": []
        },
        "taskParamList": [],
        "taskParamMap": null,
        "flag": "YES",
        "taskPriority": "MEDIUM",
        "userName": null,
        "projectName": null,
        "workerGroup": "default",
        "environmentCode": -1,
        "failRetryTimes": 2,
        "failRetryInterval": 1,
        "timeoutFlag": "CLOSE",
        "timeoutNotifyStrategy": "WARN",
        "timeout": 0,
        "delayTime": 0,
        "resourceIds": "",
        "createTime": "2024-05-09 09:16:26",
        "updateTime": "2024-05-09 09:19:54",
        "modifyBy": null,
        "taskGroupId": 0,
        "taskGroupPriority": 0,
        "cpuQuota": -1,
        "memoryMax": -1,
        "taskExecuteType": "BATCH",
        "operator": 1,
        "operateTime": "2024-05-09 09:19:54"
      },
      {
        "id": 128,
        "code": 13544367880865,
        "name": "roi计算",
        "version": 3,
        "description": "",
        "projectCode": 7461621920032,
        "userId": 1,
        "taskType": "SPARK",
        "taskParams": {
          "localParams": [],
          "rawScript": "INSERT\n    OVERWRITE TABLE buzi_mkt.mkt_sky_media_roi_inc_d PARTITION (dt = '2024-04-01')\nSELECT\n    'project' as project,\n    'media_name' as media_name,\n    23 as ad_placement_type,\n    0.6 as after_discount,\n    11 as new,\n    33 as promotion_back,\n    22 as promotion_back7,\n    1.1 as roi_cost,\n    2.2 as new_lt365,\n    3.3 as new_lt730,\n    4.4 as old_lt365,\n    5.5 as old_lt730,\n    6.6 as arpu_rate,\n    7.7 as wight_lt365,\n    8.8 as wight_lt730,\n    9.9 as income365,\n    9.8 as cost365,\n    9.7 as income730,\n    9.6 as cost730,\n    9.5 as roi1,\n    9.4 as roi2;",
          "resourceList": [],
          "programType": "SQL",
          "mainClass": "",
          "deployMode": "local",
          "sparkVersion": "S",
          "driverCores": 1,
          "driverMemory": "512M",
          "numExecutors": 2,
          "executorMemory": "2G",
          "executorCores": 2
        },
        "taskParamList": [],
        "taskParamMap": null,
        "flag": "YES",
        "taskPriority": "MEDIUM",
        "userName": null,
        "projectName": null,
        "workerGroup": "default",
        "environmentCode": -1,
        "failRetryTimes": 2,
        "failRetryInterval": 1,
        "timeoutFlag": "CLOSE",
        "timeoutNotifyStrategy": "WARN",
        "timeout": 0,
        "delayTime": 0,
        "resourceIds": "",
        "createTime": "2024-05-09 09:16:26",
        "updateTime": "2024-05-09 09:19:54",
        "modifyBy": null,
        "taskGroupId": 0,
        "taskGroupPriority": 0,
        "cpuQuota": -1,
        "memoryMax": -1,
        "taskExecuteType": "BATCH",
        "operator": 1,
        "operateTime": "2024-05-09 09:19:54"
      },
      {
        "id": 129,
        "code": 13544367880866,
        "name": "茄子roi全量更新",
        "version": 3,
        "description": "",
        "projectCode": 7461621920032,
        "userId": 1,
        "taskType": "SPARK",
        "taskParams": {
          "localParams": [],
          "rawScript": "insert\n    overwrite table buzi_mkt.mkt_sky_media_roi_acc_d partition(dt = '2024-04-01')\nselect\n    project,\n    media_name,\n    ad_placement_type,\n    after_discount,\n    new,\n    roi_cost,\n    new_lt365,\n    new_lt730,\n    arpu_rate,\n    wight_lt365,\n    wight_lt730,\n    income365,\n    cost365,\n    income730,\n    cost730,\n    roi1,\n    roi2,\n    '2024-04-01' as data_date\nfrom\n    buzi_mkt.mkt_sky_media_roi_inc_d\nwhere\n    dt = '2024-04-01';",
          "resourceList": [],
          "programType": "SQL",
          "mainClass": "",
          "deployMode": "local",
          "sparkVersion": "SPARK2",
          "driverCores": 1,
          "driverMemory": "512M",
          "numExecutors": 2,
          "executorMemory": "2G",
          "executorCores": 2
        },
        "taskParamList": [],
        "taskParamMap": null,
        "flag": "YES",
        "taskPriority": "MEDIUM",
        "userName": null,
        "projectName": null,
        "workerGroup": "default",
        "environmentCode": -1,
        "failRetryTimes": 2,
        "failRetryInterval": 1,
        "timeoutFlag": "CLOSE",
        "timeoutNotifyStrategy": "WARN",
        "timeout": 0,
        "delayTime": 0,
        "resourceIds": "",
        "createTime": "2024-05-09 09:16:26",
        "updateTime": "2024-05-09 09:19:54",
        "modifyBy": null,
        "taskGroupId": 0,
        "taskGroupPriority": 0,
        "cpuQuota": -1,
        "memoryMax": -1,
        "taskExecuteType": "BATCH",
        "operator": 1,
        "operateTime": "2024-05-09 09:19:54"
      }
    ],
    "schedule": null
  }
]